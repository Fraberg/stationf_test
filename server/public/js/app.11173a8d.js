(function(e){function t(t){for(var r,o,i=t[0],s=t[1],u=t[2],d=0,p=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(p.length)p.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,i=1;i<n.length;i++){var s=n[i];0!==a[s]&&(r=!1)}r&&(c.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},a={app:0},c=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],s=i.push.bind(i);i.push=t,i=i.slice();for(var u=0;u<i.length;u++)t(i[u]);var l=s;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"55d8":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function a(e,t,n,a,c,o){var i=Object(r["r"])("RoomComponent");return Object(r["l"])(),Object(r["e"])(i)}n("a4d3"),n("e01a"),n("b0c0");var c=Object(r["A"])("data-v-e8905c96");Object(r["n"])("data-v-e8905c96");var o={class:"container"},i={class:"form-container"},s={class:"mb-4"},u={class:"datepicker-subtemplate flex flex-col sm:flex-row justify-start items-center"},l={class:"date-picker-input-wrapper relative flex-grow"},d=Object(r["i"])("p",{class:"label-input"},"Début",-1),p=Object(r["i"])("span",{class:"flex-shrink-0 m-2"},null,-1),b={class:"date-picker-input-wrapper relative flex-grow"},f=Object(r["i"])("p",{class:"label-input"},"Fin",-1),m={class:"capacity"},v=Object(r["i"])("p",{class:"label-capacity"},"Capacité",-1),O={class:"equipments"},g=Object(r["i"])("p",{class:"label-equipments"},"Équipements",-1),j={class:"label-display-if-booked"},h=Object(r["i"])("p",{class:"display-if-booked"},"Afficher les salles réservées",-1),y={class:"filters-synthesis"},w=Object(r["i"])("hr",null,null,-1),k={class:"rooms-container"},R=Object(r["g"])('<div class="list-headers" data-v-e8905c96><p class="name" data-v-e8905c96>Nom</p><p class="capacity" data-v-e8905c96>Capacité</p><p class="description" data-v-e8905c96>Description</p><p class="equipments" data-v-e8905c96>Équipements</p><p class="reservation" data-v-e8905c96>Réservation</p></div><hr data-v-e8905c96>',2),D={key:0,class:"loading"},x=Object(r["i"])("h2",null,"Chargement des salles ...",-1),q={key:1,class:"error"},E={class:"name"},S={class:"capacity"},M={class:"description"},_={class:"equipments"},A={class:"reservation"},T={key:1},I={key:2};Object(r["m"])();var C=c((function(e,t,n,a,C,P){var V=Object(r["r"])("v-date-picker");return Object(r["l"])(),Object(r["e"])("div",o,[Object(r["i"])("div",i,[Object(r["i"])("form",{class:"bg-white shadow-md rounded px-8 pt-6 pb-8",onSubmit:t[5]||(t[5]=Object(r["z"])((function(){}),["prevent"]))},[Object(r["i"])("div",s,[Object(r["i"])(V,{modelValue:C.range,"onUpdate:modelValue":t[1]||(t[1]=function(e){return C.range=e}),mode:"dateTime",masks:C.masks,"is-range":"","min-date":(new Date).setHours(0,0,0,0),"minute-increment":5},{default:c((function(e){var t=e.inputValue,n=e.inputEvents,a=e.isDragging;return[Object(r["i"])("div",u,[Object(r["i"])("div",l,[d,Object(r["i"])("input",Object(r["k"])({class:["flex-grow pl-8 pr-2 py-1 bg-gray-100 border rounded w-full",a?"text-gray-600":"text-gray-900"],value:t.start},Object(r["t"])(n.start)),null,16,["value"])]),p,Object(r["i"])("div",b,[f,Object(r["i"])("input",Object(r["k"])({class:["flex-grow pl-8 pr-2 py-1 bg-gray-100 border rounded w-full",a?"text-gray-600":"text-gray-900"],value:t.end},Object(r["t"])(n.end)),null,16,["value"])])])]})),_:1},8,["modelValue","masks","min-date"]),Object(r["i"])("div",m,[v,Object(r["y"])(Object(r["i"])("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return C.capacity=e}),type:"number",step:"1",min:"1",required:"true"},null,512),[[r["v"],C.capacity]])]),Object(r["i"])("div",O,[g,Object(r["y"])(Object(r["i"])("input",{"onUpdate:modelValue":t[3]||(t[3]=function(e){return C.selectedEquipments=e}),placeholder:"TV, Retro ..."},null,512),[[r["v"],C.selectedEquipments]])]),Object(r["i"])("div",j,[h,Object(r["y"])(Object(r["i"])("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=function(e){return C.DisplayBookedRooms=e})},null,512),[[r["u"],C.DisplayBookedRooms]])])])],32)]),Object(r["i"])("p",y,Object(r["s"])(P.synthesis),1),w,Object(r["i"])("div",k,[R,C.loading?(Object(r["l"])(),Object(r["e"])("div",D,[x])):C.error?(Object(r["l"])(),Object(r["e"])("div",q,[Object(r["i"])("p",null,Object(r["s"])(C.error),1)])):(Object(r["l"])(!0),Object(r["e"])(r["a"],{key:2},Object(r["p"])(C.rooms,(function(e,t){return Object(r["y"])((Object(r["l"])(),Object(r["e"])("div",{class:"room",item:e,index:t,key:e._id},[Object(r["i"])("p",E,Object(r["s"])(e.name),1),Object(r["i"])("p",S,Object(r["s"])(e.capacity),1),Object(r["i"])("p",M,Object(r["s"])(e.description),1),Object(r["i"])("ul",_,[(Object(r["l"])(!0),Object(r["e"])(r["a"],null,Object(r["p"])(e.equipments,(function(e,t){return Object(r["l"])(),Object(r["e"])("li",{class:"name",item:e,index:t,key:t},Object(r["s"])(e.name),9,["item","index"])})),128))]),Object(r["i"])("div",A,[e.booked?Object(r["f"])("",!0):(Object(r["l"])(),Object(r["e"])("button",{key:0,onClick:function(e){return P.createReservation(t)}},"Réserver",8,["onClick"])),e.booked?Object(r["f"])("",!0):(Object(r["l"])(),Object(r["e"])("p",T,"pour "+Object(r["s"])(P.duration),1)),e.booked?(Object(r["l"])(),Object(r["e"])("p",I,Object(r["s"])(e.bookedInfo),1)):Object(r["f"])("",!0)])],8,["item","index"])),[[r["w"],e.capacity>=C.capacity&&(!e.booked||C.DisplayBookedRooms)&&(!C.selectedEquipments.length||e.includesSelectedEquipments)]])})),128))])])})),P=(n("99af"),n("4160"),n("caad"),n("d81d"),n("d3b7"),n("ac1f"),n("25f0"),n("2532"),n("1276"),n("159b"),n("96cf"),n("1da1")),V=n("5530"),J=n("d4ec"),U=n("bee2"),Y=n("bc3a"),B=n.n(Y),F="api/rooms/",L=function(){function e(){Object(J["a"])(this,e)}return Object(U["a"])(e,null,[{key:"getRooms",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Promise((function(t,n){B.a.get(F,{params:{capacity:e}}).then((function(e){var n=e.data;t(n.map((function(e){return Object(V["a"])(Object(V["a"])({},e),{},{createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)})})))})).catch((function(e){n(e)}))}))}},{key:"insertRoom",value:function(e){return B.a.post(F,{text:e})}},{key:"deleteRoom",value:function(e){return B.a.delete("".concat(F).concat(e))}}]),e}(),H=L,N="api/reservations/",$=function(){function e(){Object(J["a"])(this,e)}return Object(U["a"])(e,null,[{key:"getReservations",value:function(e){return new Promise((function(t,n){B.a.get(N,{params:{range:e}}).then((function(e){var n=e.data;t(n.map((function(e){return Object(V["a"])(Object(V["a"])({},e),{},{start:new Date(e.start),end:new Date(e.end),createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)})})))})).catch((function(e){n(e)}))}))}},{key:"insertReservation",value:function(e,t,n){return B.a.post(N,{user_id:"",room_id:e._id,start:new Date(t.start.getTime()+0),end:new Date(t.end.getTime()+0),participants:n})}},{key:"deleteReservation",value:function(e){return B.a.delete("".concat(N).concat(e))}}]),e}(),z=$,G=n("fa7d"),K=n.n(G),Q={name:"RoomComponent",data:function(){return{range:{start:K.a.roundDate(new Date(Date.now()),5),end:K.a.roundDate(new Date(Date.now()+18e5),5)},masks:{input:"YYYY-MM-DD h:mm A"},capacity:2,selectedEquipments:"",DisplayBookedRooms:!1,rooms:[],reservations:[],error:"",loading:!0}},computed:{synthesis:function(){if(""===this.duration){var e="Erreur : la durée de la réservation doit être supérieure ou égale à 5 minutes";return this.setError(e),e}this.setError();var t="".concat(K.a.formatDate(this.range.start)," - ").concat(K.a.formatDate(this.range.end)," (").concat(this.duration,") | ").concat(this.capacity," places");return""!=this.selectedEquipments&&(t+=" | équipée de : ".concat(this.selectedEquipments)),t},duration:function(){return K.a.getDuration(this.range.start,this.range.end)}},created:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,H.getRooms();case 3:return e.rooms=t.sent,console.log("created | this.rooms",e.rooms),t.next=7,z.getReservations(e.range);case 7:return e.reservations=t.sent,console.log("created | this.reservations",e.reservations),t.next=11,e.filterRooms();case 11:t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](0),e.error=t.t0.message;case 16:return t.prev=16,e.loading=!1,t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[0,13,16,19]])})))()},watch:{range:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,z.getReservations(e.range);case 3:return e.reservations=t.sent,e.loading=!1,t.next=7,e.filterRooms();case 7:case"end":return t.stop()}}),t)})))()},selectedEquipments:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.filterRooms();case 2:case"end":return t.stop()}}),t)})))()}},methods:{setError:function(e){this.error=e},checkIfRoomIncludesSelectedEquipments:function(e){this.selectedEquipments.split(" ").forEach((function(t){e.equipments.forEach((function(n){n.name.toLowerCase().includes(t.toLowerCase())&&(e.includesSelectedEquipments=!0)}))}))},filterRooms:function(){var e=this;return Object(P["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=e.rooms,e.rooms=n.map((function(e){var t=Object.assign({},e);return t.booked=!1,t.includesSelectedEquipments=!1,t})),e.rooms.forEach((function(t){e.selectedEquipments.length&&e.checkIfRoomIncludesSelectedEquipments(t),e.reservations.forEach((function(n){n.room_id===t._id&&(n.start>=e.range.start&&n.start<e.range.end&&(t.booked=!0,t.bookedInfo="Réservée le ".concat(n.start.getDate()," à partir de ").concat(K.a.formatTime(n.start))),n.end>e.range.start&&n.end<=e.range.end&&(t.booked=!0,t.bookedInfo="Réservée le ".concat(n.end.getDate()," jusqu'à ").concat(K.a.formatTime(n.end))))}))}));case 3:case"end":return t.stop()}}),t)})))()},createReservation:function(e){var t=this;return Object(P["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(r=t.rooms[e],console.log("createReservation("+e.toString()+")",r),!r){n.next=13;break}return r.booked=!0,r.bookedInfo="Réservée le ".concat(t.range.start.getDate()," à partir de ").concat(K.a.formatTime(t.range.start)),t.$swal("Réservation enregistrée","Du ".concat(K.a.formatDate(t.range.start),"<br>au ").concat(K.a.formatDate(t.range.end),"<br>Durée de ").concat(t.duration,"<br>Pour ").concat(t.capacity," places (").concat(r.capacity," au total)"),"success"),n.next=8,z.insertReservation(r,t.range,t.capacity);case 8:return n.next=10,z.getReservations(t.range);case 10:t.reservations=n.sent,n.next=14;break;case 13:t.$swal("Oops...","Impossible de réserver cette salle","error");case 14:case"end":return n.stop()}}),n)})))()}}};n("5bac");Q.render=C,Q.__scopeId="data-v-e8905c96";var W=Q,X={name:"App",components:{RoomComponent:W}};n("dcb3");X.render=a;var Z=X,ee=n("7b37"),te=n("5886");n("4413");Object(r["d"])(Z).use(ee["a"],{}).use(te["default"]).mount("#app")},"5bac":function(e,t,n){"use strict";n("55d8")},c22b:function(e,t,n){},dcb3:function(e,t,n){"use strict";n("c22b")},fa7d:function(e,t,n){n("99af"),n("d3b7"),n("25f0"),n("6062"),n("3ca3"),n("ddb0");var r=n("448a");function a(e,t){e=e.toString();while(e.length<t)e="0"+e;return e}function c(e){return"".concat(a(e.getHours(),2),":").concat(a(e.getMinutes(),2))}function o(e){var t=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],n=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"];return"".concat(t[e.getDay()]," ").concat(a(e.getDate(),2)," ").concat(n[e.getMonth()]," ").concat(e.getFullYear()," ").concat(c(e))}function i(e,t){var n=6e4*t,r=new Date(Math.round(e.getTime()/n)*n);return r}function s(e,t){var n=i(e,t);return n.getTime()>e.getTime()?n:new Date(n.getTime()+6e4*t)}function u(e,t){var n=t-e,r=Math.floor(n/864e5),a=Math.floor(n%864e5/36e5),c=Math.round(n%864e5%36e5/6e4);if(0===r&&0===a&&0===c)return"";var o="";return r>0&&(o+="".concat(r," jour"),o+=r>=2?"s ":" "),a>0&&(o+="".concat(a," heure"),o+=a>=2?"s ":" "),c>0&&(o+="".concat(c," minute"),o+=c>=2?"s":""),o}function l(e){var t;return(t=String.prototype).concat.apply(t,r(new Set(e)))}function d(e,t,n){return e>=t&&e<=n}e.exports={formatTime:c,formatDate:o,roundDate:s,getDuration:u,getUniqueCharactersIn:l,dateIsInRange:d}}});
//# sourceMappingURL=app.11173a8d.js.map